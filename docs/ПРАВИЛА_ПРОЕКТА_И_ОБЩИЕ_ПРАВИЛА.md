# Правила проекта и общие правила для всех проектов

Документ фиксирует, какие правила уже есть в проекте, что в них добавлено, и что рекомендуется добавить в **общие правила Cursor для всех проектов** (глобальные настройки пользователя).

---

## 1. Правила проекта (уже есть и что добавлено)

Расположение: **`.cursor/rules/`**. Применяются в этом репозитории.

| Файл | Назначение |
|------|------------|
| **artifacts-no-auto-close.mdc** | Не переводить артефакты в статус «закрыто» без явного подтверждения пользователя. |
| **artifacts-task-numbering.mdc** | Общая нумерация VET-NNN, привязка планов и спринтов к ARTIFACTS.md, формат коммитов. |
| **project-conventions.mdc** *(новый)* | Структура фич (Clean Architecture), линтер и тесты, язык комментариев и документации, напоминание про коммиты и VET-XXX. |

Идея: в проекте есть реестр артефактов (ARTIFACTS.md), ветки/коммиты привязаны к VET-XXX, статусы не закрываются автоматически, код следует структуре lib/features и analysis_options.

---

## 2. Что добавить в общие правила для всех проектов

Общие правила задаются в Cursor в настройках пользователя (например, **Settings → Cursor Settings → Rules → "Rules for all projects"** или файл в `~/.cursor/`). Ниже — формулировки, которые можно туда скопировать.

### 2.1. Язык ответов

- Отвечать на том же языке, на котором написан запрос пользователя.
- Если в проекте задано правило по языку (например, «всегда на русском») — следовать правилу проекта.

### 2.2. Артефакты и статусы

- В проектах с реестром артефактов (ARTIFACTS.md, BUGS.md, JIRA, задачи в docs):
  - **Не переводить** задачи/баги в статус «закрыто» (или аналог) **без явного указания пользователя**.
  - **Задачи:** после реализации помечать как «реализовано», «выполнено» (или аналог по формату реестра). Статус «закрыто» — только после согласования пользователя.
  - При исправлении бага обновлять статус до «исправлен» (или аналог), если так принято в проекте; «закрыто» — только по подтверждению пользователя.

### 2.3. Привязка изменений к задачам

- Если в проекте есть реестр задач (ARTIFACTS, ISSUES, JIRA и т.п.):
  - В коммитах и в описании изменений указывать ID задачи/бага (например, VET-078, ISSUE-123).
  - Новые задачи добавлять в реестр по правилам проекта (следующий номер, нужная таблица), а не придумывать локальную нумерацию без привязки.

### 2.4. Тесты и линтер

- При изменении кода учитывать существующие тесты: не ломать их без явной цели; при добавлении фичи или исправлении бага — предлагать или добавлять тесты, если это уместно.
- Соблюдать линтер и стиль проекта (например, analysis_options.yaml, ESLint, Prettier). Не отключать правила линтера и не менять конфиг без явной просьбы пользователя.

### 2.5. Безопасность

- Не помещать секреты, API-ключи, пароли в код и в коммиты. Использовать переменные окружения, секреты CI/CD или конфиг вне репозитория. В примерах и документации — плейсхолдеры (например, `YOUR_API_KEY`).

### 2.6. Планирование и рефакторинг

- При крупном рефакторинге или многозадачном плане: уточнять границы или составлять краткий план/чек-лист перед массовыми правками.
- В режиме планирования (plan mode) не вносить изменения в код и не выполнять команды с побочными эффектами до явного подтверждения пользователя.

### 2.7. Документация

- При добавлении новых API, сущностей или форматов данных учитывать необходимость обновления документации (README, ТЗ, API-docs) и при необходимости предлагать правки.

---

## 3. Краткая сводка

**В проекте «Ассистент ветеринара»:**  
Используются три правила: запрет авто-закрытия артефактов, нумерация VET-NNN и привязка планов к реестру, соглашения по структуре кода, тестам и коммитам (project-conventions).

**Для всех проектов (глобально):**  
Рекомендуется добавить общие принципы: язык ответов, не закрывать артефакты без подтверждения, привязка к задачам в коммитах, учёт тестов и линтера, безопасность секретов, планирование рефакторинга, учёт документации.

При необходимости эти блоки можно скопировать в настройки Cursor как «Rules for all projects» или в отдельный глобальный файл правил.
