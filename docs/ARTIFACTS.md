# Реестр артефактов проекта

Сквозная нумерация для быстрого поиска и идентификации. Все изменения в коде и коммиты привязываются к артефактам по ID (например, `VET-001`).

**Формат ID:** `VET-NNN` (VET — префикс проекта, NNN — порядковый номер).

---

## Типы артефактов

| Код | Тип        | Описание                    |
|-----|------------|-----------------------------|
| B   | Bug        | Баг, дефект                 |
| T   | Task       | Задача (что нужно доделать) |
| R   | Requirement| Пункт ТЗ / чек-листа MVP    |

---

## Статусы (баги и подтверждение исправлений)

| Статус     | Описание |
|------------|----------|
| **открыт** | Баг воспроизводится, исправление не внесено (или не закоммичено). |
| **исправлен** | В код внесено исправление, записано в BUGS.md (секция «Исправление»). Требуется проверка. |
| **закрыто** | Исправление подтверждено: пересборка/тесты пройдены, баг больше не воспроизводится. Артефакт закрыт. |

Переход: *открыт* → *исправлен* (после коммита исправления) → *закрыто* (после подтверждения, что баг устранён).

**Правило процесса:** артефакты **не переводить в статус «закрыто» автоматически**. Переход в «закрыто» допускается **только по явному подтверждению** ответственного (разработчика/владельца проекта): после проверки (пересборка, тесты) вы сами обновляете статус в ARTIFACTS.md и BUGS.md.

---

## Баги (B)

| ID     | Краткое название                          | Статус   | Где описан |
|--------|-------------------------------------------|----------|------------|
| VET-001 | В PDF не отображаются русские символы    | закрыто | [BUGS.md](BUGS.md#vet-001) |
| VET-037 | В админке по кнопке «Выход» не всегда попадаешь в список пациентов | закрыто | [BUGS.md](BUGS.md#vet-037) |
| VET-038 | После добавления протокола не обновляется список протоколов у пациента на экране | закрыто | [BUGS.md](BUGS.md#vet-038) |
| VET-039 | Экспорт JSON в админке: непонятно, как сохранить или отправить JSON | закрыто | [BUGS.md](BUGS.md#vet-039) |
| VET-040 | flutter analyze: ReferenceRepositoryImpl не присваивается ReferenceRepository (DI, пути, Drift orderBy) | исправлен | [BUGS.md](BUGS.md#vet-040) |
| VET-041 | flutter analyze: отсутствует native_speech_service.dart, использование NativeSpeechService в examination_create_page | исправлен | [BUGS.md](BUGS.md#vet-041) |
| VET-042 | flutter analyze: неверный URI app_config в stt_router.dart | исправлен | [BUGS.md](BUGS.md#vet-042) |
| VET-043 | flutter analyze: const-выражение в protocol_pdf_service.dart (style18Bold), лишний import | исправлен | [BUGS.md](BUGS.md#vet-043) |
| VET-044 | flutter analyze: дублирование modelVersion в on_device_recognizer.dart | исправлен | [BUGS.md](BUGS.md#vet-044) |
| VET-045 | flutter analyze: deprecated value в DropdownButtonFormField/формах (initialValue) | исправлен | [BUGS.md](BUGS.md#vet-045) |
| VET-046 | flutter analyze: неиспользуемый import в main.dart, тест widget_test ссылается на MyApp | исправлен | [BUGS.md](BUGS.md#vet-046) |
| VET-054 | flutter analyze: синтаксическая ошибка в examination_create_page (_buildForm — лишняя скобка/запятая) | исправлен | [BUGS.md](BUGS.md#vet-054) |
| VET-073 | flutter analyze: override_on_non_overriding_member в app_database.g.dart (isActive); invocation_of_non_function в template_repository_impl (OrderingTerm) | исправлен | [BUGS.md](BUGS.md#vet-073) |
| VET-074 | В диалоге редактирования раздела наименования полей «Ключ», «Подпись» не помещаются в полях ввода | закрыто   | [BUGS.md](BUGS.md#vet-074) |
| VET-075 | При нажатии «Сохранить» в редактировании шаблона протокола не сохраняются изменения: порядок разделов, новые добавленные разделы | закрыто | [BUGS.md](BUGS.md#vet-075) |

---

## Задачи (T) — что нужно доделать

| ID     | Краткое название                                      | Фаза |
|--------|--------------------------------------------------------|------|
| VET-002 | Фото в протоколе и в PDF (UI, хранение, вставка в PDF) | 1 (выполнено) |
| VET-003 | Импорт из JSON (разбор, валидация, отчёт)             | 1    |
| VET-004 | Экспорт ZIP с медиа                                   | 1    |
| VET-005 | Запись и загрузка аудио                               | 2    |
| VET-006 | Облачное STT, парсер полей, автозаполнение формы      | 2    |
| VET-007 | Диалог уточнений, поиск пациентов голосом             | 2    |
| VET-008 | Объединено с VET-064 (редактор шаблонов, справочники, настройки валидации) | 1.3 |
| VET-009 | Офлайн STT, приватный сервер STT, UI/UX, тесты        | после MVP |
| VET-047 | Возможность редактировать протоколы осмотра (уже сохранённые) | 1 (закрыто) |
| VET-048 | Кнопки выбора типа протокола: текстовое название заменить на иконки | 1 (закрыто) |
| VET-049 | При добавлении и редактировании протокола скроллиться должен весь протокол кроме поля «Пациент» | 1 (закрыто) |
| VET-050 | При просмотре протокола выводить все поля, в том числе картинки и приложенные аудиофайлы | 1 (закрыто) |
| VET-051 | При добавлении протокола: кнопки «Записать», «Стоп», «Распознать» — только иконки (без текста); добавить кнопку «Пауза» с иконкой для паузы записи аудио | 1 (закрыто) |
| VET-052 | Рядом с файлом записи добавить кнопку «Старт/Стоп» для прослушивания и остановки записи | 1 (закрыто) |
| VET-053 | Выбор типа протокола доступен только при добавлении; при редактировании протокола тип менять нельзя | 1 (закрыто) |
| VET-055 | Убрать наименование «Тип протокола» из формы добавления/редактирования протокола | 1 (закрыто) |
| VET-056 | Кнопку сохранения протокола при добавлении/изменении перенести в правый верхний угол; убрать текст, оставить только иконку | 1 (закрыто) |
| VET-057 | В карточке пациента в списке протоколов: тип протокола заменить на иконку, дату протокола разместить справа от иконки | 1 (закрыто) |
| VET-058 | В форме просмотра протокола: название типа протокола заменить на иконку, дату протокола разместить справа от иконки типа протокола | 1 (закрыто) |
| VET-059 | В форме просмотра протокола в разделе «Данные осмотра»: все наименования полей заменить на русские, как в форме добавления/редактирования протокола | 1 (закрыто) |
| VET-060 | В форме редактирования протокола иконку типа протокола разместить слева от поля «Пациент» | 1 (закрыто) |
| VET-061 | В форме просмотра и редактирования протокола учесть нижнее меню телефона: подгонять верстку так, чтобы поля формы не перекрывались нижним меню | 1 (закрыто) |
| VET-062 | В форме редактирования пациента учесть наличие нижнего меню телефона | 1 (закрыто) |
| VET-063 | В карточке пациента сделать скроллинг протоколов с учётом наличия нижнего меню телефона | 1 (закрыто) |
| **Релиз 1.3 — декомпозиция VET-064 (редактор шаблонов протоколов)** |
| VET-065 | Редактор шаблонов: добавление, удаление, редактирование разделов протокола (CRUD разделов) | 1.3 (закрыто) |
| VET-066 | Редактор шаблонов: тип раздела, привязка к справочнику или диапазону значений | 1.3 (закрыто) |
| VET-067 | Редактор шаблонов: задание порядка разделов в протоколе (сортировка, расположение) | 1.3 (закрыто) |
| VET-068 | Редактор шаблонов: настройка вида, размера и расположения раздела в печатной форме (модель + UI) | 1.3 |
| VET-069 | Визуальный редактор печатной формы протокола (превью, перетаскивание, оформление) | 1.3 |
| **Релиз 1.3 — декомпозиция VET-070 (версии шаблонов)** |
| VET-071 | Версии шаблонов: модель данных (несколько версий на тип шаблона, признак «активна»), гарантия единственности активной версии на тип | 1.3 (закрыто) |
| VET-072 | Версии шаблонов: админка — список версий по типу, переключение активной версии; при создании протокола использовать активную версию шаблона | 1.3 |
| VET-076 | В форме редактирования шаблона протокола у кнопки «Добавить раздел» убрать текст подписи, оставить только иконку «+» | 1.3 (закрыто) |
| VET-077 | В форме редактирования шаблона протокола заменить текст «Сохранить» в правом верхнем углу на соответствующую иконку | 1.3 (закрыто) |

---

## Требования (R) — чек-лист ТЗ MVP

| ID     | # | Пункт чек-листа (кратко)                    | Статус   |
|--------|---|---------------------------------------------|----------|
| VET-010 | 1 | Добавление пациентов (поля, контакты)       | сделано  |
| VET-011 | 2 | Поиск по кличке, чипу, ФИО владельца        | сделано  |
| VET-012 | 3 | Поиск голосом                              | сделано  |
| VET-013 | 4 | Просмотр истории осмотров по пациенту       | сделано  |
| VET-014 | 5 | Лимит 10 пациентов (бесплатная версия)      | сделано  |
| VET-015 | 6 | Выбор пациента (поиск / голосом)            | сделано  |
| VET-016 | 7 | Выбор типа протокола (кардио, УЗИ, стомат) | сделано  |
| VET-017 | 8 | Запись анамнеза (голос/вручную)             | сделано  |
| VET-018 | 9 | Запись и загрузка аудио                    | сделано  |
| VET-019 |10 | STT, авто-заполнение полей                 | сделано  |
| VET-020 |11 | Уточнение данных (диалог)                  | сделано  |
| VET-021 |12 | Привязка фотографий с описанием            | сделано  |
| VET-022 |13 | Ручное редактирование протокола            | сделано  |
| VET-023 |14 | Валидация данных                           | сделано  |
| VET-024 |15 | Сохранение протокола в БД                  | сделано  |
| VET-025 |16 | Генерация PDF (с фотографиями)             | сделано  |
| VET-026 |17 | Просмотр, сохранение PDF, email, шаринг    | сделано  |
| VET-027 |18 | Облачное распознавание (STT)               | сделано  |
| VET-028 |19 | Приватный сервер STT                       | нет      |
| VET-029 |20 | Офлайн-режим STT                           | нет      |
| VET-030 |21 | Автовыбор провайдера (SttRouter)           | сделано  |
| VET-031 |22 | Вход по паролю/PIN                         | сделано  |
| VET-032 |23 | Редактирование шаблонов протоколов         | сделано  |
| VET-033 |24 | Управление справочниками                   | сделано  |
| VET-034 |25 | Настройки валидации                        | сделано  |
| VET-035 |26 | Экспорт БД (JSON, ZIP с медиа)             | сделано  |
| VET-036 |27 | Импорт из JSON, отчёт                      | сделано  |
| VET-064 |28 | Редактор шаблонов протоколов (в т.ч. редактирование шаблонов, справочники, настройки валидации — объединено с VET-008): добавление/удаление/редактирование разделов; тип раздела, выбор из справочника/диапазона; порядок разделов; настройка вида/размера/расположения в печатной форме; визуальный редактор печатной формы | нет     |
| VET-070 |29 | Поддержка разных версий шаблона одного типа; у версии шаблона — признак активности; активной может быть только одна версия шаблона данного типа | нет     |

Декомпозиция VET-064 на задачи релиза 1.3: **VET-065** … **VET-069**. Ранее отдельная задача VET-008 (редактирование шаблонов, справочники, настройки валидации) объединена с VET-064. План реализации: [ПЛАН_РЕЛИЗА_1.3.md](ПЛАН_РЕЛИЗА_1.3.md).

Декомпозиция VET-070 на задачи релиза 1.3: **VET-071**, **VET-072**. См. [ПЛАН_РЕЛИЗА_1.3.md](ПЛАН_РЕЛИЗА_1.3.md#vet-070--версии-шаблонов).

Соответствие пунктам чек-листа: [CHECKLIST_TZ_MVP.md](CHECKLIST_TZ_MVP.md).

---

## Как добавлять новые артефакты

1. Выберите следующий свободный номер (следующий после максимального VET-NNN в этом реестре).
2. Добавьте строку в соответствующую таблицу (Баги / Задачи / Требования).
3. Для багов дополнительно создайте или отредактируйте запись в [BUGS.md](BUGS.md) с тем же ID в заголовке.

**Подтверждение исправления бага:** только вы вручную, после своей проверки (пересборка, тесты), обновляете статус бага на **закрыто** в [ARTIFACTS.md](ARTIFACTS.md) и в [BUGS.md](BUGS.md). Автоматический перевод артефактов в «закрыто» не допускается.

**Коммит и пуш в облако после тестирования:** краткая инструкция — [КОММИТ_И_ПУШ.md](КОММИТ_И_ПУШ.md).

---

## Поиск по ID

- **Баги:** `VET-001`, `VET-037`, `VET-038`, `VET-039`, `VET-040` … `VET-046`, `VET-054`, `VET-073`, `VET-074`, `VET-075` → [BUGS.md](BUGS.md)
- **Задача:** VET-002 … VET-009 (VET-008 объединён с VET-064), VET-047 … VET-063, VET-065 … VET-069, VET-071, VET-072, VET-076, VET-077 → этот файл, секция «Задачи»
- **Требование ТЗ:** VET-010 … VET-036, VET-064, VET-070 → этот файл и [CHECKLIST_TZ_MVP.md](CHECKLIST_TZ_MVP.md)

Коммиты и MR должны ссылаться на ID (см. [CONTRIBUTING.md](../CONTRIBUTING.md)).
